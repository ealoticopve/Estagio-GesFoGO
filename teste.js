//var layersGeoJSON = L.layerGroup(); //timeline polygons
const mysql = require('mysql');
const connection = mysql.createConnection({
    host: '127.0.0.1',
    user: 'root',
    password: '',
    database: 'nodevisor'
});
//start connection
connection.connect((err) => {
    if (err) {
        return console.log(err.stack);
    }
    console.log("Sucessfuly connection");
});

//query for capture all properties values of instanced sensors
query = "SELECT date, AsText(`firelines_coords`) as coords FROM timeline_info"
connection.query(query, function(err, result, fields) {
    if (err) {
        console.log(err);
    }

    for (i in result) {
        //console.log(result[i].coords);
        var res = result[i].coords.split("POLYGON((");
        //console.log("1ยบ Split: " + res[1])
        var res = res[1].split("))");
        //console.log("2ยบ Split: " + res[0])
        var res = res[0].split(",");
        console.log(res)
        for (i in res) {
            console.log(i + " polygon: " + res[i])
                //console.log(res[i])
                //var res = res[i].split(" ");
                //console.log("lng: " + res[0])
                //console.log("lat: " + res)
        }
    }
});

/*
var sliderControl = L.control.sliderControl({ position: "bottomleft", layer: layersGeoJSON, range: true });
mymap.addControl(sliderControl);
sliderControl.startSlider();
*/

//close connection
connection.end(() => {
    console.log("Connection closed with sucess.");
});


/*insert

INSERT INTO timeline_info (`firelines_coords`,`date`)
VALUES(PolygonFromText('POLYGON((-16.893112091737557 32.751589401074156,-16.920664420821403 32.751819589648335,-16.94118391324711 32.76159954908414,-16.926709719676907 32.73215569845409,-16.893112091737557 32.751589401074156))'),'2020-05-29 07:16:19')

);*/

/*SELECT
SELECT date, AsText(`firelines_coords`) as coords FROM timeline_info
*/

/*
1- POLYGON((-16.893112091737557 32.751589401074156,-16.920664420821403 32.751819589648335,-16.94118391324711 32.76159954908414,-16.926709719676907 32.73215569845409,-16.893112091737557 32.751589401074156))'),'2020-05-29 07:16:19')
2- POLYGON((-16.893112091737557 32.751589401074156,-16.903290807577005 32.75090009950632,-16.902947158160163 32.75609735628938,-16.908789198246613 32.75797406892621,-16.912053867706682 32.7553755332057,-16.913600290082517 32.749745112369105,-16.920664420821403 32.751819589648335,-16.94118391324711 32.76159954908414,-16.926709719676907 32.73215569845409,-16.893112091737557 32.751589401074156))'),'2020-05-29 07:26:19')
3- POLYGON((-16.893112091737557 32.751589401074156,-16.903290807577005 32.75090009950632,-16.902947158160163 32.75609735628938,-16.908789198246613 32.75797406892621,-16.912053867706682 32.7553755332057,-16.913600290082517 32.749745112369105,-16.920664420821403 32.751819589648335,-16.94118391324711 32.76159954908414,-16.93473472921877 32.74151539554975,-16.94109224343051 32.743536799933636,-16.942810490514763 32.74267048938444,-16.946590634100097 32.743248030686466,-16.94951165414334 32.73689487047408,-16.95174537535286 32.73357372010094,-16.94985530356018 32.732851714513465,-16.943154139931604 32.73819441736631, -16.93336013155138 32.73732805487708, -16.926709719676907 32.73215569845409,-16.893112091737557 32.751589401074156))'),'2020-05-29 07:36:19')
4- POLYGON((-16.893112091737557 32.751589401074156,-16.903290807577005 32.75090009950632,-16.902947158160163 32.75609735628938,-16.908789198246613 32.75797406892621,-16.912053867706682 32.7553755332057,-16.913600290082517 32.749745112369105,-16.920664420821403 32.751819589648335,-16.94118391324711 32.76159954908414,-16.93473472921877 32.74151539554975,-16.94109224343051 32.743536799933636,-16.942810490514763 32.74267048938444,-16.946590634100097 32.743248030686466,-16.94951165414334 32.73689487047408,-16.95174537535286 32.73357372010094,-16.94985530356018 32.732851714513465,-16.943154139931604 32.73819441736631, -16.93336013155138 32.73732805487708,-16.91268645049729 32.72577575026935, -16.91749754233319 32.71999903656541,-16.91749754233319 32.71711053937849, -16.92196498475225 32.71075551627421,-16.900315071490702 32.7116221369942,-16.881758002980785 32.708733368521614,-16.88141435356394 32.71248874929537,-16.891036537235745 32.71855479966606,-16.894816680821098 32.726931048100624,-16.926709719676907 32.73215569845409,-16.893112091737557 32.751589401074156))'),'2020-05-29 07:36:19')
*/